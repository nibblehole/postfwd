<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>postfwd - docker support [devel]</title>
<link rel="stylesheet" type="text/css" href="/css/postfwd.css">
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
<meta name="description" content="postfwd docker support">
<meta name="author" content="jpk">
<meta name="keywords" content="postfwd, postfwd usage, postfwd manual, postfwd docker, docker, postfix, policy, policy delegation, firewall, postfix acl, postfix acls, pfwpolicy, postfw, restrictions, IT-Security, IT-Consulting, Jan, Peter, Kessler">
<style type="text/css" media="screen">
#CommandBox { font-size: 1.15em; color: #3D1600; background: #E5E4E2; padding-left: 20px; padding-right: 20px; padding-top: 1px; padding-bottom: 1px; border: none; width:90%; margin-top: .1em; margin-bottom: .7em; }
#Command { color: #2B547E; };
</style>
</head>

<body>
<h2>postfwd docker support [devel]</h2>

To run postfwd in a docker container you will need to access the development aka testing branch (at least version 1.36-devel2). You can use the pre-built image "postfwd/postfwd:testing" from DockerHub or download the postfwd distibution and build the image by yourself.<br>

<br>
<br>
<h3>Quicknav</h3>
<ul>
  <li><a href="#c001">Using a pre-built image</a>
  <ul>
    <li><a href="#c001s001">docker</a>
    <li><a href="#c001s002">docker-compose</a>
  </ul>
<br>
  <li><a href="#c002">Building your own image</a>
  <ul>
    <li><a href="#c002s001">get postfwd docker files</a>
    <li><a href="#c002s002">docker</a>
    <li><a href="#c002s003">docker-compose</a>
  </ul>
</ul>
<br>

<a name="c001"><h3>Using a pre-built image</h3></a>

<a name="c001s001"><h4>a.) docker</h4></a>
<ul>
<li>Get the image:
   <div id="CommandBox"><pre><code>docker pull postfwd/postfwd:testing</code></pre></div>
<li>Execute a container based on that image:
   <div id="CommandBox"><pre><code>docker run -v <strong id="Command">/path/to/ruleset</strong>:/etc/postfwd/postfwd.cf:ro -it postfwd/postfwd:testing</code></pre></div>
</ul>

<a name="c001s002"><h4>b.) docker-compose</h4></a>

<ul>
<li>Create docker-compose.yml:
   <div id="CommandBox"><pre><code>version: '2'

services:
  postfwd-testing:
    image: postfwd/postfwd:testing
    restart: always
    ports:
      # Modify interface and port below if required!
      - <strong id="Command">127.0.0.1:10040</strong>:10040
    volumes:
      # Do not forget to create your ruleset an change /path/to/ruleset below!
      - <strong id="Command">/path/to/ruleset</strong>:/etc/postfwd/postfwd.cf:ro</code></pre></div>
<li>Execute the container:
   <div id="CommandBox"><pre><code>docker-compose up</code></pre></div>
</ul>

<br>
<a name="c002"><h3>Building your own image</h3></a>

<a name="c002s001"><h4>Get the postfwd docker files</h4></a>

The files "Dockerfile" and "docker-compose.yml" which were used to build the images at DockerHub can be found within the
"docker"-subfolder of the postfwd distribution. You can find it at:<br>

<ul>
<li><a href="https://github.com/postfwd/postfwd/tree/testing">GitHub</a>:
   <div id="CommandBox"><pre><code>git clone https://github.com/postfwd/postfwd --branch testing --single-branch postfwd</code></pre></div>
<li><a href="https://postfwd.org/DEVEL/?C=M;O=D">postfwd.org/DEVEL</a>:
   <div id="CommandBox"><pre><code>wget https://postfwd.org/DEVEL/postfwd-latest.tar.gz && gzip -dc postfwd-latest.tar.gz | tar -xf - && rm postfwd-latest.tar.gz</code></pre></div>
</ul>

<a name="c002s002"><h4>a.) docker</h4></a>

<ul>
<li>Edit the Dockerfile and build the image:
   <div id="CommandBox"><pre><code>docker build --no-cache --pull -t postfwd:testing .</code></pre></div>
<li>Execute a container based on that image:
   <div id="CommandBox"><pre><code>docker run -v <strong id="Command">/path/to/ruleset</strong>:/etc/postfwd/postfwd.cf:ro -it postfwd:testing</code></pre></div>
</ul>

<a name="c002s003"><h4>b.) docker-compose</h4></a>

<ul>
<li>Edit the Dockerfile and the docker-compose.yml file and build the image:
   <div id="CommandBox"><pre><code>docker-compose build --no-cache --pull</code></pre></div>
<li>Execute the container:
   <div id="CommandBox"><pre><code>docker-compose up</code></pre></div>
</ul>

</body>
</html>

